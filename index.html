<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trading Dashboard</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        
        :root {
            --bg: #060a13;
            --bg2: #0b1120;
            --card: #0f1729;
            --card-hover: #162035;
            --border: #1a2744;
            --border-light: #243356;
            --text: #e8edf5;
            --text-dim: #5a6b8a;
            --green: #00e68a;
            --green-glow: rgba(0, 230, 138, 0.15);
            --green-bg: rgba(0, 230, 138, 0.08);
            --red: #ff4d6a;
            --red-glow: rgba(255, 77, 106, 0.15);
            --red-bg: rgba(255, 77, 106, 0.08);
            --blue: #4d8dff;
            --blue-glow: rgba(77, 141, 255, 0.2);
            --purple: #a78bfa;
            --gold: #fbbf24;
            --gold-bg: rgba(251, 191, 36, 0.08);
            --cyan: #22d3ee;
        }
        
        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
        }

        .green { color: var(--green) !important; }
        .red { color: var(--red) !important; }
        .blue { color: var(--blue) !important; }
        
        /* Background effects */
        .bg-grid {
            position: fixed; inset: 0;
            background-image: 
                linear-gradient(rgba(77,141,255,0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(77,141,255,0.02) 1px, transparent 1px);
            background-size: 80px 80px;
            z-index: 0; pointer-events: none;
        }
        
        .bg-glow {
            position: fixed; top: -300px; left: 50%; transform: translateX(-50%);
            width: 1000px; height: 1000px;
            background: radial-gradient(circle, rgba(77,141,255,0.06) 0%, rgba(167,139,250,0.03) 40%, transparent 70%);
            z-index: 0; animation: pulse 10s ease-in-out infinite; pointer-events: none;
        }
        
        @keyframes pulse {
            0%,100% { opacity: 0.5; transform: translateX(-50%) scale(1); }
            50% { opacity: 1; transform: translateX(-50%) scale(1.15); }
        }
        
        .container { position: relative; z-index: 1; max-width: 1400px; margin: 0 auto; padding: 24px; }
        
        /* Animations */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(24px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes shimmer {
            0% { background-position: -200% center; }
            100% { background-position: 200% center; }
        }
        @keyframes countUp { from { opacity: 0.3; } to { opacity: 1; } }
        @keyframes gradientMove {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .anim-fade { animation: fadeInUp 0.6s ease-out both; }
        .anim-delay-1 { animation-delay: 0.1s; }
        .anim-delay-2 { animation-delay: 0.2s; }
        .anim-delay-3 { animation-delay: 0.3s; }
        .anim-delay-4 { animation-delay: 0.4s; }
        .anim-delay-5 { animation-delay: 0.5s; }
        .anim-delay-6 { animation-delay: 0.6s; }
        
        /* Header */
        .header {
            text-align: center; padding: 48px 0 36px;
            animation: fadeIn 0.8s ease-out;
        }
        .header h1 {
            font-size: 2.8rem; font-weight: 900; letter-spacing: -1px;
            background: linear-gradient(135deg, #4d8dff, #a78bfa, #ff4d94, #4d8dff);
            background-size: 300% 300%;
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            animation: gradientMove 6s ease infinite;
            margin-bottom: 10px;
        }
        .header p { color: var(--text-dim); font-size: 1.05rem; font-weight: 400; letter-spacing: 0.5px; }
        .last-update {
            color: var(--text-dim); font-size: 0.78rem; margin-top: 8px;
            background: var(--card); display: inline-block; padding: 4px 14px;
            border-radius: 20px; border: 1px solid var(--border);
        }
        
        /* Portfolio Summary */
        .portfolio-summary {
            display: grid; grid-template-columns: 1fr 1fr; gap: 16px;
            margin-bottom: 28px;
        }
        .portfolio-card {
            background: var(--card); border: 1px solid var(--border); border-radius: 18px;
            padding: 24px 28px; position: relative; overflow: hidden;
        }
        .portfolio-card::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
        }
        .portfolio-card.realized::before {
            background: linear-gradient(90deg, var(--blue), var(--purple));
        }
        .portfolio-card.unrealized::before {
            background: linear-gradient(90deg, var(--green), var(--cyan));
        }
        .portfolio-card .label { font-size: 0.78rem; color: var(--text-dim); margin-bottom: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }
        .portfolio-card .big-val { font-size: 2.2rem; font-weight: 900; letter-spacing: -1px; }
        .portfolio-card .sub-val { font-size: 0.82rem; color: var(--text-dim); margin-top: 6px; }
        .portfolio-card { transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .portfolio-card:hover { transform: translateY(-2px); box-shadow: 0 8px 32px rgba(0,0,0,0.2); }
        
        /* Top Stats Bar */
        .top-stats {
            display: flex; gap: 0; justify-content: center;
            margin-bottom: 28px; padding: 0;
            background: var(--card); border: 1px solid var(--border); border-radius: 18px;
            overflow: hidden;
        }
        .top-stat {
            flex: 1; text-align: center; padding: 20px 24px;
            border-left: 1px solid var(--border); transition: background 0.3s;
        }
        .top-stat:last-child { border-left: none; }
        .top-stat:hover { background: var(--card-hover); }
        .top-stat .label { font-size: 0.72rem; color: var(--text-dim); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600; }
        .top-stat .value { font-size: 1.5rem; font-weight: 800; }
        .top-stat .sub { font-size: 0.75rem; margin-top: 4px; font-weight: 500; }
        
        /* Month Selector */
        .month-selector { display: flex; gap: 8px; align-items: center; margin-bottom: 20px; }
        .month-btn {
            background: var(--card); border: 1px solid var(--border); color: var(--text-dim);
            padding: 10px 20px; border-radius: 12px; cursor: pointer; font-family: inherit;
            font-size: 0.85rem; font-weight: 600; transition: all 0.3s;
        }
        .month-btn:hover { border-color: var(--blue); color: var(--text); background: var(--card-hover); }
        .month-btn.active {
            background: linear-gradient(135deg, rgba(77,141,255,0.15), rgba(167,139,250,0.1));
            border-color: var(--blue); color: var(--blue);
        }
        
        /* Calendar */
        .calendar-wrapper {
            background: var(--card); border: 1px solid var(--border); border-radius: 18px;
            padding: 28px; margin-bottom: 28px;
        }
        .calendar-header {
            display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px; margin-bottom: 10px;
        }
        .calendar-header div {
            text-align: center; font-size: 0.75rem; font-weight: 700;
            color: var(--text-dim); padding: 8px 0; text-transform: uppercase; letter-spacing: 1px;
        }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px; }
        .cal-day {
            aspect-ratio: 1; border-radius: 12px; display: flex;
            flex-direction: column; align-items: center; justify-content: center;
            font-size: 0.85rem; position: relative; transition: all 0.2s ease;
            border: 1px solid transparent; min-height: 74px; gap: 2px;
        }
        .cal-day.empty { opacity: 0; pointer-events: none; }
        .cal-day.has-data { cursor: pointer; }
        .cal-day.positive { border-color: rgba(0,230,138,0.15); }
        .cal-day.positive.intensity-1 { background: rgba(0,230,138,0.04); }
        .cal-day.positive.intensity-2 { background: rgba(0,230,138,0.08); }
        .cal-day.positive.intensity-3 { background: rgba(0,230,138,0.14); border-color: rgba(0,230,138,0.25); }
        .cal-day.negative { border-color: rgba(255,77,106,0.15); }
        .cal-day.negative.intensity-1 { background: rgba(255,77,106,0.04); }
        .cal-day.negative.intensity-2 { background: rgba(255,77,106,0.08); }
        .cal-day.negative.intensity-3 { background: rgba(255,77,106,0.14); border-color: rgba(255,77,106,0.25); }
        .cal-day.no-data { background: rgba(90,107,138,0.02); }
        .cal-day.zero { background: rgba(90,107,138,0.04); border-color: rgba(90,107,138,0.1); }
        .cal-day.today { box-shadow: 0 0 0 2px var(--blue), 0 0 16px rgba(77,141,255,0.12); }
        .cal-day:hover.has-data { transform: scale(1.06); z-index: 2; box-shadow: 0 6px 20px rgba(0,0,0,0.3); }
        .cal-day .day-num { font-weight: 600; font-size: 0.82rem; color: var(--text); line-height: 1; }
        .cal-day.has-data .day-num { font-weight: 700; }
        .cal-day:not(.has-data) .day-num { color: var(--text-dim); font-weight: 400; opacity: 0.5; }
        .cal-day .day-pnl { font-weight: 700; font-size: 0.68rem; line-height: 1; }
        .cal-day .day-pnl.green { color: var(--green); }
        .cal-day .day-pnl.red { color: var(--red); }
        .cal-day .day-pnl.dim { color: var(--text-dim); font-weight: 400; font-size: 0.6rem; }
        
        /* Tooltip */
        .cal-day .tooltip {
            display: none; position: absolute; bottom: calc(100% + 8px); left: 50%; transform: translateX(-50%);
            background: #1a2744; border: 1px solid var(--border-light); border-radius: 10px;
            padding: 10px 14px; font-size: 0.78rem; white-space: nowrap; z-index: 100;
            box-shadow: 0 8px 32px rgba(0,0,0,0.4); pointer-events: none;
        }
        .cal-day .tooltip::after {
            content: ''; position: absolute; top: 100%; left: 50%; transform: translateX(-50%);
            border: 6px solid transparent; border-top-color: #1a2744;
        }
        .cal-day:hover .tooltip { display: block; }
        
        /* Cumulative PnL bar */
        .cumulative-bar {
            margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border);
        }
        .cumulative-bar .cum-label { font-size: 0.78rem; color: var(--text-dim); margin-bottom: 8px; font-weight: 600; }
        .cum-track { height: 6px; background: rgba(90,107,138,0.1); border-radius: 3px; overflow: hidden; position: relative; }
        .cum-fill { height: 100%; border-radius: 3px; transition: width 1s ease; }
        .cum-values { display: flex; justify-content: space-between; margin-top: 6px; font-size: 0.72rem; color: var(--text-dim); }
        
        /* Stats Cards */
        .stats-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
            gap: 14px; margin-bottom: 28px;
        }
        .stat-card {
            background: var(--card); border: 1px solid var(--border); border-radius: 16px;
            padding: 22px; transition: all 0.3s ease; position: relative; overflow: hidden;
        }
        .stat-card::after {
            content: ''; position: absolute; inset: 0; border-radius: 16px;
            background: linear-gradient(135deg, transparent 60%, rgba(77,141,255,0.03));
            pointer-events: none;
        }
        .stat-card:hover { transform: translateY(-3px); border-color: rgba(77,141,255,0.3); box-shadow: 0 8px 32px rgba(0,0,0,0.2); }
        .stat-card .icon { font-size: 1.5rem; margin-bottom: 8px; }
        .stat-card .label { color: var(--text-dim); font-size: 0.78rem; margin-bottom: 8px; font-weight: 500; }
        .stat-card .value { font-size: 1.7rem; font-weight: 800; }
        .stat-card .sub { color: var(--text-dim); font-size: 0.72rem; margin-top: 6px; }
        
        /* Win Rate Bar */
        .winrate-bar { margin-top: 10px; height: 5px; background: var(--red-bg); border-radius: 3px; overflow: hidden; }
        .winrate-fill { height: 100%; background: var(--green); border-radius: 3px; transition: width 1.5s ease; }
        
        /* Streak Section */
        .streak-section {
            margin-bottom: 28px; background: var(--card); border: 1px solid var(--border);
            border-radius: 18px; padding: 24px 28px;
        }
        .streak-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; flex-wrap: wrap; gap: 12px; }
        .streak-header .section-title { margin-bottom: 0; }
        .streak-counters { display: flex; gap: 16px; }
        .streak-counter {
            padding: 8px 16px; border-radius: 10px; font-size: 0.82rem; font-weight: 700;
        }
        .streak-counter.current { background: var(--blue-glow); color: var(--blue); }
        .streak-counter.best { background: var(--green-glow); color: var(--green); }
        .streak-counter.worst { background: var(--red-glow); color: var(--red); }
        .streak-bar { display: flex; gap: 5px; flex-wrap: wrap; }
        .streak-dot {
            width: 36px; height: 36px; border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            font-size: 0.7rem; font-weight: 800; transition: transform 0.2s;
        }
        .streak-dot:hover { transform: scale(1.15); }
        .streak-win { background: var(--green-glow); color: var(--green); border: 1px solid rgba(0,230,138,0.2); }
        .streak-loss { background: var(--red-glow); color: var(--red); border: 1px solid rgba(255,77,106,0.2); }
        
        /* Rules */
        .rules-banner {
            background: linear-gradient(135deg, rgba(251,191,36,0.05), rgba(255,77,106,0.03));
            border: 1px solid rgba(251,191,36,0.15); border-radius: 16px;
            padding: 18px 24px; margin-bottom: 28px;
            display: flex; flex-wrap: wrap; gap: 10px; align-items: center;
        }
        .rules-banner .rule-title { font-weight: 800; color: var(--gold); font-size: 0.9rem; margin-left: 14px; }
        .rules-banner .rule {
            background: rgba(0,0,0,0.3); padding: 6px 14px; border-radius: 8px;
            font-size: 0.75rem; color: var(--text-dim); border: 1px solid var(--border);
            font-weight: 500;
        }
        
        /* Open Positions */
        .pos-card {
            border-radius: 18px;
            padding: 24px; position: relative; overflow: hidden;
            border: 1px solid var(--border);
            background: var(--card);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .pos-card:hover { transform: translateY(-4px); }
        .pos-card.pos-profit {
            border-color: rgba(0,230,138,0.25);
            background: linear-gradient(135deg, rgba(0,230,138,0.04) 0%, var(--card) 40%, rgba(34,211,238,0.03) 100%);
            box-shadow: 0 0 40px rgba(0,230,138,0.06), 0 4px 24px rgba(0,0,0,0.2);
        }
        .pos-card.pos-profit:hover { box-shadow: 0 0 60px rgba(0,230,138,0.1), 0 8px 32px rgba(0,0,0,0.3); }
        .pos-card.pos-loss {
            border-color: rgba(255,77,106,0.2);
            background: linear-gradient(135deg, rgba(255,77,106,0.04) 0%, var(--card) 40%);
            box-shadow: 0 0 40px rgba(255,77,106,0.04), 0 4px 24px rgba(0,0,0,0.2);
        }
        .pos-card.pos-loss:hover { box-shadow: 0 0 60px rgba(255,77,106,0.08), 0 8px 32px rgba(0,0,0,0.3); }
        .pos-card::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px;
        }
        .pos-card.pos-profit::before { background: linear-gradient(90deg, var(--green), var(--cyan)); }
        .pos-card.pos-loss::before { background: linear-gradient(90deg, var(--red), #ff7eb3); }
        .pos-card::after {
            content: ''; position: absolute; top: -50%; right: -50%; width: 200%; height: 200%;
            background: radial-gradient(circle at center, transparent 30%, transparent 100%);
            pointer-events: none; opacity: 0; transition: opacity 0.5s;
        }
        .pos-card.pos-profit::after {
            background: radial-gradient(circle at 80% 20%, rgba(0,230,138,0.03) 0%, transparent 50%);
            opacity: 1;
        }
        @keyframes profitPulse {
            0%, 100% { box-shadow: 0 0 40px rgba(0,230,138,0.06), 0 4px 24px rgba(0,0,0,0.2); }
            50% { box-shadow: 0 0 50px rgba(0,230,138,0.1), 0 4px 24px rgba(0,0,0,0.2); }
        }
        .pos-card.pos-profit { animation: profitPulse 4s ease-in-out infinite; }
        .pos-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 18px; }
        .pos-pair { font-size: 1.3rem; font-weight: 800; }
        .pos-badges { display: flex; gap: 6px; }
        .pos-badge {
            padding: 4px 10px; border-radius: 8px; font-size: 0.7rem; font-weight: 700;
            background: rgba(90,107,138,0.12); color: var(--text-dim);
        }
        .pos-badge.long { background: var(--green-glow); color: var(--green); }
        .pos-badge.short { background: var(--red-glow); color: var(--red); }
        .pos-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 14px; }
        .pos-item .pos-label { font-size: 0.7rem; color: var(--text-dim); margin-bottom: 3px; font-weight: 500; }
        .pos-item .pos-val { font-size: 1rem; font-weight: 700; }
        .pos-pnl-big { font-size: 2.2rem; font-weight: 900; letter-spacing: -1px; }
        .pos-pnl-big.green { text-shadow: 0 0 30px rgba(0,230,138,0.3); }
        .pos-pnl-big.red { text-shadow: 0 0 30px rgba(255,77,106,0.3); }
        .pos-roi { font-size: 1.15rem; font-weight: 700; margin-top: 4px; }
        .pos-tpsl {
            margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border);
            display: flex; gap: 24px; font-size: 0.85rem; flex-wrap: wrap;
        }
        .pos-tpsl span {
            background: rgba(255,255,255,0.03); padding: 6px 12px; border-radius: 8px;
            border: 1px solid var(--border);
        }
        .live-dot {
            width: 8px; height: 8px; border-radius: 50%; background: var(--green);
            display: inline-block; margin-left: 8px; box-shadow: 0 0 8px var(--green);
            animation: blink 1.5s infinite;
        }
        @keyframes blink { 0%,100% { opacity: 1; } 50% { opacity: 0.3; } }
        
        /* Trades Table */
        .section-title { font-size: 1.1rem; font-weight: 800; margin-bottom: 16px; letter-spacing: -0.3px; display: flex; align-items: center; gap: 8px; }
        .trades-wrapper {
            background: var(--card); border: 1px solid var(--border); border-radius: 18px; overflow: hidden;
            margin-bottom: 40px;
        }
        .trades-table { width: 100%; border-collapse: collapse; }
        .trades-table th {
            background: rgba(77,141,255,0.04); padding: 14px 16px; text-align: right;
            font-size: 0.72rem; font-weight: 700; color: var(--text-dim);
            border-bottom: 1px solid var(--border); white-space: nowrap;
            text-transform: uppercase; letter-spacing: 0.5px;
        }
        .trades-table td {
            padding: 13px 16px; font-size: 0.85rem;
            border-bottom: 1px solid rgba(26,39,68,0.5); white-space: nowrap;
        }
        .trades-table tr { transition: background 0.2s; }
        .trades-table tr:hover td { background: var(--card-hover); }
        .badge { display: inline-block; padding: 4px 10px; border-radius: 6px; font-size: 0.7rem; font-weight: 700; }
        .badge-long { background: var(--green-glow); color: var(--green); }
        .badge-short { background: var(--red-glow); color: var(--red); }
        .badge-mixed { background: var(--blue-glow); color: var(--blue); }
        
        .empty-state { text-align: center; padding: 50px 20px; color: var(--text-dim); }
        .empty-state h3 { font-size: 1.1rem; margin-bottom: 6px; color: var(--text); }
        
        /* Dividers */
        .section-divider {
            height: 1px; background: linear-gradient(90deg, transparent, var(--border), transparent);
            margin: 8px 0 24px;
        }
        
        /* Particles */
        .particle {
            position: fixed; width: 2px; height: 2px;
            background: rgba(77,141,255,0.25); border-radius: 50%;
            animation: floatUp linear infinite; z-index: 0; pointer-events: none;
        }
        @keyframes floatUp {
            0% { transform: translateY(100vh); opacity: 0; }
            10% { opacity: 1; } 90% { opacity: 1; }
            100% { transform: translateY(-100px); opacity: 0; }
        }
        
        /* Equity Curve */
        .equity-curve-wrapper {
            background: var(--card); border: 1px solid var(--border); border-radius: 18px;
            padding: 24px 28px; margin-bottom: 28px; overflow: hidden;
        }
        .equity-curve-wrapper .section-title { margin-bottom: 12px; }
        .equity-svg { width: 100%; height: 200px; }
        .equity-svg .line { fill: none; stroke-width: 2.5; stroke-linecap: round; stroke-linejoin: round; }
        .equity-svg .area { opacity: 0.12; }
        .equity-svg .grid-line { stroke: var(--border); stroke-width: 0.5; stroke-dasharray: 4 4; }
        .equity-svg .dot { r: 3.5; stroke-width: 2; cursor: pointer; transition: r 0.2s; }
        .equity-svg .dot:hover { r: 6; }
        .equity-svg .axis-label { fill: var(--text-dim); font-size: 10px; font-family: Inter, sans-serif; }
        .equity-svg .zero-line { stroke: var(--text-dim); stroke-width: 0.5; stroke-dasharray: 6 3; opacity: 0.4; }

        /* PnL Bar Chart */
        .bar-chart-wrapper {
            background: var(--card); border: 1px solid var(--border); border-radius: 18px;
            padding: 24px 28px; margin-bottom: 28px;
        }
        .bar-svg { width: 100%; height: 180px; }
        .bar-svg .bar { rx: 3; ry: 3; cursor: pointer; transition: opacity 0.2s; }
        .bar-svg .bar:hover { opacity: 0.75; }
        .bar-svg .bar-label { fill: var(--text-dim); font-size: 9px; font-family: Inter, sans-serif; text-anchor: middle; }
        .bar-svg .bar-val { font-size: 8px; font-family: Inter, sans-serif; font-weight: 700; text-anchor: middle; }

        /* Discipline Score */
        .discipline-wrapper {
            background: var(--card); border: 1px solid var(--border); border-radius: 18px;
            padding: 24px 28px; margin-bottom: 28px; text-align: center;
        }
        .discipline-ring-container { display: inline-block; position: relative; width: 160px; height: 160px; margin: 12px 0; }
        .discipline-ring { transform: rotate(-90deg); }
        .discipline-ring .bg-ring { fill: none; stroke: var(--border); stroke-width: 10; }
        .discipline-ring .fg-ring { fill: none; stroke-width: 10; stroke-linecap: round; transition: stroke-dashoffset 1.5s ease, stroke 0.5s; }
        .discipline-score-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 2.4rem; font-weight: 900; }
        .discipline-label { font-size: 0.82rem; color: var(--text-dim); margin-top: 4px; }
        .discipline-factors { display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; margin-top: 16px; }
        .discipline-factor {
            background: rgba(255,255,255,0.03); border: 1px solid var(--border); border-radius: 10px;
            padding: 8px 14px; font-size: 0.75rem; display: flex; align-items: center; gap: 6px;
        }
        .factor-ok { color: var(--green); }
        .factor-warn { color: var(--gold); }
        .factor-bad { color: var(--red); }

        /* Advanced Stats */
        .adv-stats-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 12px; margin-bottom: 28px;
        }
        .adv-stat {
            background: var(--card); border: 1px solid var(--border); border-radius: 14px;
            padding: 18px; text-align: center; transition: transform 0.3s, border-color 0.3s;
        }
        .adv-stat:hover { transform: translateY(-2px); border-color: var(--blue); }
        .adv-stat .adv-label { font-size: 0.7rem; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600; margin-bottom: 6px; }
        .adv-stat .adv-value { font-size: 1.4rem; font-weight: 800; }

        /* Goal Tracker */
        .goal-wrapper {
            background: linear-gradient(135deg, rgba(77,141,255,0.04), rgba(167,139,250,0.04));
            border: 1px solid var(--border); border-radius: 18px;
            padding: 24px 28px; margin-bottom: 28px;
        }
        .goal-bar-track { height: 12px; background: rgba(90,107,138,0.1); border-radius: 6px; overflow: hidden; position: relative; margin: 14px 0 8px; }
        .goal-bar-fill { height: 100%; border-radius: 6px; transition: width 1.5s ease; position: relative; }
        .goal-bar-fill::after { content: ''; position: absolute; right: 0; top: -2px; bottom: -2px; width: 4px; background: white; border-radius: 2px; box-shadow: 0 0 8px rgba(255,255,255,0.5); }
        .goal-info { display: flex; justify-content: space-between; font-size: 0.82rem; }
        .goal-info .current { font-weight: 700; }
        .goal-milestones { display: flex; gap: 10px; margin-top: 12px; flex-wrap: wrap; }
        .goal-milestone { font-size: 0.72rem; padding: 4px 10px; border-radius: 6px; background: rgba(255,255,255,0.03); border: 1px solid var(--border); color: var(--text-dim); }
        .goal-milestone.reached { background: var(--green-glow); color: var(--green); border-color: rgba(0,230,138,0.2); }

        /* Footer */
        .footer {
            text-align: center; padding: 40px 0 20px; color: var(--text-dim);
            font-size: 0.75rem; border-top: 1px solid var(--border); margin-top: 20px;
        }
        
        /* Mobile */
        @media (max-width: 768px) {
            .container { padding: 14px; }
            .header h1 { font-size: 2rem; }
            .header { padding: 32px 0 24px; }
            .portfolio-summary { grid-template-columns: 1fr; gap: 12px; }
            .portfolio-card { padding: 20px; }
            .portfolio-card .big-val { font-size: 1.6rem; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); gap: 10px; }
            .stat-card { padding: 16px; }
            .stat-card .value { font-size: 1.3rem; }
            .top-stats { flex-direction: column; }
            .top-stat { border-left: none; border-bottom: 1px solid var(--border); padding: 16px; }
            .top-stat:last-child { border-bottom: none; }
            .trades-wrapper { overflow-x: auto; -webkit-overflow-scrolling: touch; }
            .cal-day { min-height: 58px; border-radius: 10px; }
            .cal-day .day-num { font-size: 0.78rem; }
            .cal-day .day-pnl { font-size: 0.6rem; }
            .calendar-wrapper { padding: 16px; }
            .calendar-grid { gap: 4px; }
            .streak-dot { width: 30px; height: 30px; }
            .rules-banner { padding: 14px 16px; }
            .pos-card { padding: 20px; }
            .pos-pnl-big { font-size: 1.7rem; }
            .pos-grid { grid-template-columns: repeat(3, 1fr); gap: 12px; }
            .pos-tpsl { gap: 16px; font-size: 0.82rem; flex-wrap: wrap; }
            .streak-section { padding: 18px; }
            .month-btn { padding: 8px 14px; font-size: 0.8rem; }
        }
        
        @media (max-width: 768px) {
            #disciplineGoalRow { grid-template-columns: 1fr !important; }
            .equity-curve-wrapper, .bar-chart-wrapper { padding: 16px; }
            .equity-svg { height: 160px; }
            .bar-svg { height: 150px; }
            .adv-stats-grid { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 400px) {
            .stats-grid { grid-template-columns: 1fr 1fr; gap: 8px; }
            .cal-day { min-height: 48px; }
        }
    </style>
</head>
<body>
    <div class="bg-grid"></div>
    <div class="bg-glow"></div>
    <script>
        for(let i=0;i<10;i++){const p=document.createElement('div');p.className='particle';p.style.left=Math.random()*100+'%';p.style.animationDuration=(18+Math.random()*25)+'s';p.style.animationDelay=Math.random()*12+'s';document.body.appendChild(p);}
    </script>
    
    <div class="container">
        <!-- Header -->
        <div class="header anim-fade">
            <h1>ğŸ“Š Trading Dashboard</h1>
            <p>Futures PnL Analysis</p>
            <div class="last-update" id="lastUpdate"></div>
        </div>
        
        <!-- Portfolio Summary -->
        <div class="portfolio-summary anim-fade anim-delay-1">
            <div class="portfolio-card realized">
                <div class="label">ğŸ’° Total Realized PnL</div>
                <div class="big-val" id="totalRealizedPnl">$0</div>
                <div class="sub-val" id="totalRealizedPct"></div>
            </div>
            <div class="portfolio-card unrealized">
                <div class="label">ğŸ“Š Total Unrealized PnL</div>
                <div class="big-val" id="totalUnrealizedPnl">$0</div>
                <div class="sub-val" id="totalUnrealizedSub">From open positions</div>
            </div>
        </div>
        
        <!-- Top Stats -->
        <div class="top-stats anim-fade anim-delay-2">
            <div class="top-stat">
                <div class="label">Today</div>
                <div class="value" id="todayPnl">$0</div>
                <div class="sub" id="todayPct"></div>
            </div>
            <div class="top-stat">
                <div class="label">7 Days</div>
                <div class="value" id="weekPnl">$0</div>
                <div class="sub" id="weekPct"></div>
            </div>
            <div class="top-stat">
                <div class="label">All Time</div>
                <div class="value" id="monthPnl">$0</div>
                <div class="sub" id="monthPct"></div>
            </div>
        </div>
        
        <!-- Month Selector -->
        <div class="month-selector anim-fade anim-delay-2" id="monthSelector"></div>
        
        <!-- Calendar -->
        <div class="calendar-wrapper anim-fade anim-delay-3">
            <div class="calendar-header">
                <div>SUN</div><div>MON</div><div>TUE</div><div>WED</div><div>THU</div><div>FRI</div><div>SAT</div>
            </div>
            <div class="calendar-grid" id="calendarGrid"></div>
            <div class="cumulative-bar" id="cumulativeBar"></div>
        </div>
        
        <!-- Equity Curve -->
        <div class="equity-curve-wrapper anim-fade anim-delay-2">
            <div class="section-title">ğŸ“ˆ Equity Curve (All Time)</div>
            <svg class="equity-svg" id="equityCurve" preserveAspectRatio="none"></svg>
        </div>

        <!-- Daily PnL Bar Chart -->
        <div class="bar-chart-wrapper anim-fade anim-delay-3">
            <div class="section-title">ğŸ“Š Daily PnL â€” <span id="barChartMonth"></span></div>
            <svg class="bar-svg" id="barChart" preserveAspectRatio="none"></svg>
        </div>

        <!-- Discipline + Goal row -->
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:0;" class="anim-fade anim-delay-3" id="disciplineGoalRow">
            <!-- Discipline Score -->
            <div class="discipline-wrapper">
                <div class="section-title" style="justify-content:center;">ğŸ›¡ï¸ Discipline Score</div>
                <div class="discipline-ring-container">
                    <svg class="discipline-ring" viewBox="0 0 160 160" width="160" height="160">
                        <circle class="bg-ring" cx="80" cy="80" r="65"/>
                        <circle class="fg-ring" id="disciplineRing" cx="80" cy="80" r="65"/>
                    </svg>
                    <div class="discipline-score-text" id="disciplineScore">0</div>
                </div>
                <div class="discipline-label" id="disciplineLabel">Calculating...</div>
                <div class="discipline-factors" id="disciplineFactors"></div>
            </div>

            <!-- Goal Tracker -->
            <div class="goal-wrapper">
                <div class="section-title">ğŸ¯ Monthly Goal</div>
                <div id="goalContent"></div>
            </div>
        </div>

        <!-- Advanced Stats -->
        <div class="section-title anim-fade anim-delay-3" style="margin-top:28px;">âš¡ Advanced Analytics</div>
        <div class="section-divider"></div>
        <div class="adv-stats-grid anim-fade anim-delay-3" id="advStats"></div>

        <!-- Stats Cards -->
        <div class="section-title anim-fade anim-delay-3">ğŸ“ˆ Monthly Statistics</div>
        <div class="section-divider"></div>
        <div class="stats-grid" id="statsGrid">
            <div class="stat-card anim-fade anim-delay-3">
                <div class="icon">ğŸ“Š</div>
                <div class="label">×¡×”"×› ×™××™ ××¡×—×¨</div>
                <div class="value blue" id="totalTrades">0</div>
            </div>
            <div class="stat-card anim-fade anim-delay-3">
                <div class="icon">ğŸ¯</div>
                <div class="label">Win Rate</div>
                <div class="value" id="winRate" style="color:var(--purple)">0%</div>
                <div class="winrate-bar"><div class="winrate-fill" id="winRateBar" style="width:0%"></div></div>
            </div>
            <div class="stat-card anim-fade anim-delay-4">
                <div class="icon">ğŸ†</div>
                <div class="label">×”×¨×•×•×— ×”×’×“×•×œ</div>
                <div class="value green" id="bestDay">$0</div>
            </div>
            <div class="stat-card anim-fade anim-delay-4">
                <div class="icon">ğŸ’¥</div>
                <div class="label">×”×”×¤×¡×“ ×”×’×“×•×œ</div>
                <div class="value red" id="worstDay">$0</div>
            </div>
            <div class="stat-card anim-fade anim-delay-5">
                <div class="icon">âœ…</div>
                <div class="label">×™××™× ×™×¨×•×§×™×</div>
                <div class="value green" id="greenDays">0</div>
            </div>
            <div class="stat-card anim-fade anim-delay-5">
                <div class="icon">âŒ</div>
                <div class="label">×™××™× ××“×•××™×</div>
                <div class="value red" id="redDays">0</div>
            </div>
        </div>
        
        <!-- Streak -->
        <div class="streak-section anim-fade anim-delay-4" id="streakSection" style="display:none;">
            <div class="streak-header">
                <div class="section-title">ğŸ”¥ ×¨×¦×£ ×™××™× ××—×¨×•× ×™×</div>
                <div class="streak-counters" id="streakCounters"></div>
            </div>
            <div class="streak-bar" id="streakBar"></div>
        </div>
        
        <!-- Open Positions -->
        <div id="openPositionsSection" class="anim-fade anim-delay-4">
            <div class="section-title">ğŸ”´ ×¤×•×–×™×¦×™×•×ª ×¤×ª×•×—×•×ª <span class="live-dot"></span></div>
            <div class="section-divider"></div>
            <div id="openPositions" style="display:flex;flex-direction:column;gap:14px;margin-bottom:28px;"></div>
        </div>
        
        <!-- Rules -->
        <div class="rules-banner anim-fade anim-delay-5">
            <span class="rule-title">âš ï¸ ×›×œ×œ×™ ×‘×¨×–×œ</span>
            <span class="rule">×¡×™×›×•×Ÿ 1-2% ×œ×˜×¨×™×™×“</span>
            <span class="rule">××§×¡×™××•× $50 ×”×¤×¡×“ ×™×•××™</span>
            <span class="rule">×œ×•×•×¨×’' ×¢×“ x10</span>
            <span class="rule">R/R ××™× ×™××œ×™ 1:2</span>
            <span class="rule">2 ×”×¤×¡×“×™× = ×¢×¦×•×¨!</span>
        </div>
        
        <!-- Trades Table -->
        <div class="anim-fade anim-delay-5">
            <div class="section-title">ğŸ“‹ ×”×™×¡×˜×•×¨×™×™×ª ×¢×¡×§××•×ª</div>
            <div class="section-divider"></div>
            <div class="trades-wrapper">
                <table class="trades-table">
                    <thead>
                        <tr>
                            <th>#</th><th>×ª××¨×™×š</th><th>××˜×‘×¢</th><th>×›×™×•×•×Ÿ</th>
                            <th>×›× ×™×¡×”</th><th>×™×¦×™××”</th><th>×œ×•×•×¨×’'</th><th>×ª×•×¦××”</th><th>×”×¢×¨×•×ª</th>
                        </tr>
                    </thead>
                    <tbody id="tradesBody"></tbody>
                </table>
                <div class="empty-state" id="emptyTrades" style="display:none;">
                    <h3>ğŸ“­ ×¢×“×™×™×Ÿ ××™×Ÿ ×¢×¡×§××•×ª ×‘×•×“×“×•×ª</h3>
                    <p>×©×œ×— ×¢×¡×§××•×ª ×œ×¡×¤×™×œ×‘×¨×’ ×‘×•×•××˜×¡××¤</p>
                </div>
            </div>
        </div>
        
        <div class="footer">Trading Dashboard &copy; 2026 â€” Data updates via WhatsApp Bot</div>
    </div>
    
    <script>
    // ==================== DATA ====================
    const DAILY_PNL = {
        "2026-01": {
            1: -12.06,
            11: -0.82,
            16: 13.54,
            17: -10.46,
            18: -1130,
            19: 95.20,
            20: -970.32,
            21: 144.59,
            22: -120.23,
            23: 269.81,
            24: -76.41,
            25: -1400,
            26: -734.83,
            27: 18.66,
            28: -131.32,
            29: -41.04
        },
        "2026-02": {
            5: -46.56,
            9: 1.75,
            10: -0.92,
            11: 7.21,
            12: -1.29,
            13: -98.37,
            14: -6.44,
            18: -116.05,
            19: 57.97,
            20: -19.81,
            21: 188.24,
            22: 46.89,
            23: -465.97,
            24: 221.69
        }
    };
    
    const OPEN_POSITIONS = [
        {
            pair: "CYBER/USDT",
            direction: "LONG",
            leverage: "20X",
            mode: "Cross",
            entry: 0.5235,
            markPrice: 0.5412,
            size: 5895.6,
            margin: 156.19,
            unrealizedPnl: 102.72,
            roi: 66.55,
            tp: 0.6533,
            sl: 0.5296,
            liqPrice: 0.3929,
            realizedPnl: 36.57
        },
        {
            pair: "SOL/USDT",
            direction: "LONG",
            leverage: "60X",
            mode: "Cross",
            entry: 76.70,
            markPrice: 78.22,
            size: 60.00,
            margin: 79.47,
            unrealizedPnl: 88.95,
            roi: 115.96,
            tp: 80.97,
            sl: 76.74,
            liqPrice: 63.92,
            realizedPnl: 171.39
        }
    ];
    
    // Generate TRADES from DAILY_PNL
    const TRADES = [];
    Object.entries(DAILY_PNL).forEach(([monthKey, days]) => {
        const [y, m] = monthKey.split('-');
        Object.entries(days).forEach(([day, pnl]) => {
            TRADES.push({
                date: `${String(day).padStart(2,'0')}/${m}/${y}`,
                pair: "Futures",
                dir: pnl >= 0 ? "LONG" : "SHORT",
                entry: "-",
                exit: "-",
                lev: "-",
                result: pnl,
                notes: "Daily PnL",
                _sort: `${monthKey}-${String(day).padStart(2,'0')}`
            });
        });
    });
    TRADES.sort((a, b) => a._sort.localeCompare(b._sort));
    
    const INITIAL_ASSETS = 693.33;
    
    // ==================== RENDER ====================
    let currentMonth = "2026-02";
    
    function getMonths() { return Object.keys(DAILY_PNL).sort(); }
    
    function renderMonthSelector() {
        const el = document.getElementById('monthSelector');
        const months = getMonths();
        const names = {"01":"×™× ×•××¨","02":"×¤×‘×¨×•××¨","03":"××¨×¥","04":"××¤×¨×™×œ","05":"×××™","06":"×™×•× ×™","07":"×™×•×œ×™","08":"××•×’×•×¡×˜","09":"×¡×¤×˜××‘×¨","10":"××•×§×˜×•×‘×¨","11":"× ×•×‘××‘×¨","12":"×“×¦××‘×¨"};
        el.innerHTML = months.map(m => {
            const [y, mm] = m.split('-');
            return `<button class="month-btn ${m===currentMonth?'active':''}" onclick="setMonth('${m}')">${names[mm]} ${y}</button>`;
        }).join('');
    }
    
    function setMonth(m) { currentMonth = m; renderMonthSelector(); renderCalendar(); renderStats(); renderBarChart(); renderDiscipline(); renderGoalTracker(); }
    
    function renderCalendar() {
        const grid = document.getElementById('calendarGrid');
        const [year, month] = currentMonth.split('-').map(Number);
        const firstDay = new Date(year, month-1, 1).getDay();
        const daysInMonth = new Date(year, month, 0).getDate();
        const data = DAILY_PNL[currentMonth] || {};
        const today = new Date();
        const isCurrentMonth = today.getFullYear()===year && today.getMonth()===month-1;
        
        let html = '';
        for (let i=0; i<firstDay; i++) html += '<div class="cal-day empty"></div>';
        
        let cumulative = 0;
        const cumData = [];
        
        for (let d=1; d<=daysInMonth; d++) {
            const pnl = data[d];
            const hasData = pnl !== undefined;
            const isToday = isCurrentMonth && today.getDate()===d;
            if (hasData) { cumulative += pnl; cumData.push({day:d, cum:cumulative}); }
            
            let cls = 'cal-day';
            if (hasData) {
                cls += ' has-data';
                if (pnl > 0) {
                    cls += ' positive';
                    cls += Math.abs(pnl) > 200 ? ' intensity-3' : Math.abs(pnl) > 50 ? ' intensity-2' : ' intensity-1';
                } else if (pnl < 0) {
                    cls += ' negative';
                    cls += Math.abs(pnl) > 200 ? ' intensity-3' : Math.abs(pnl) > 50 ? ' intensity-2' : ' intensity-1';
                } else { cls += ' zero'; }
            } else { cls += ' no-data'; }
            if (isToday) cls += ' today';
            
            let pnlStr = '';
            let tooltipHtml = '';
            if (hasData) {
                const prefix = pnl>0?'+':'';
                const colorCls = pnl>0?'green':pnl<0?'red':'dim';
                const absVal = Math.abs(pnl);
                const display = absVal >= 1000 ? `${prefix}$${(pnl/1000).toFixed(1)}K` : `${prefix}$${pnl.toFixed(2)}`;
                pnlStr = `<div class="day-pnl ${colorCls}">${display}</div>`;
                tooltipHtml = `<div class="tooltip"><strong>${d}/${String(month).padStart(2,'0')}/${year}</strong><br>PnL: <span style="color:${pnl>=0?'var(--green)':'var(--red)'};font-weight:700">${prefix}$${pnl.toFixed(2)}</span><br>Cumulative: $${cumulative.toFixed(2)}</div>`;
            } else {
                pnlStr = '<div class="day-pnl dim">â€”</div>';
            }
            
            html += `<div class="${cls}">${tooltipHtml}<div class="day-num">${d}</div>${pnlStr}</div>`;
        }
        grid.innerHTML = html;
        
        // Cumulative bar
        const cumBar = document.getElementById('cumulativeBar');
        if (cumData.length > 0) {
            const monthTotal = cumulative;
            const maxAbs = Math.max(...cumData.map(c => Math.abs(c.cum)), 1);
            const pct = Math.min(Math.abs(monthTotal) / maxAbs * 50 + 50, 100);
            const color = monthTotal >= 0 ? 'var(--green)' : 'var(--red)';
            cumBar.innerHTML = `
                <div class="cum-label">Monthly Cumulative PnL</div>
                <div class="cum-track"><div class="cum-fill" style="width:${pct}%;background:${color}"></div></div>
                <div class="cum-values"><span>Start: $0</span><span style="color:${color};font-weight:700">End: ${monthTotal>=0?'+':''}$${monthTotal.toFixed(2)}</span></div>
            `;
        }
    }
    
    function animateCount(el, target, prefix, suffix, duration) {
        const start = 0;
        const startTime = performance.now();
        const isNeg = target < 0;
        function update(now) {
            const elapsed = now - startTime;
            const progress = Math.min(elapsed / duration, 1);
            const eased = 1 - Math.pow(1 - progress, 3);
            const current = start + (target - start) * eased;
            const sign = current > 0 ? '+' : '';
            el.textContent = prefix + sign + '$' + current.toFixed(2) + suffix;
            if (progress < 1) requestAnimationFrame(update);
        }
        requestAnimationFrame(update);
    }
    
    function calcStreaks(allDays) {
        let current = 0, best = 0, worst = 0, tempWin = 0, tempLoss = 0;
        for (const d of allDays) {
            if (d.val >= 0) { tempWin++; tempLoss = 0; best = Math.max(best, tempWin); }
            else { tempLoss++; tempWin = 0; worst = Math.max(worst, tempLoss); }
        }
        current = tempWin > 0 ? tempWin : -tempLoss;
        return { current, best, worst };
    }
    
    function renderStats() {
        const data = DAILY_PNL[currentMonth] || {};
        const monthVals = Object.values(data);
        
        // All days sorted
        const allDays = [];
        Object.entries(DAILY_PNL).forEach(([month, days]) => {
            Object.entries(days).forEach(([day, val]) => {
                allDays.push({ month, day: parseInt(day), val, sort: month+'-'+String(day).padStart(2,'0') });
            });
        });
        allDays.sort((a,b) => a.sort.localeCompare(b.sort));
        
        const todayVal = (DAILY_PNL["2026-02"] || {})[24] || 0;
        const last7 = allDays.slice(-7).reduce((s,d) => s+d.val, 0);
        const allTime = allDays.reduce((s,d) => s+d.val, 0);
        
        setStatVal('todayPnl', todayVal);
        setStatVal('weekPnl', last7);
        document.getElementById('weekPct').textContent = `(${(last7/INITIAL_ASSETS*100).toFixed(2)}%)`;
        document.getElementById('weekPct').style.color = last7>=0?'var(--green)':'var(--red)';
        setStatVal('monthPnl', allTime);
        document.getElementById('monthPct').textContent = `(${(allTime/INITIAL_ASSETS*100).toFixed(2)}%)`;
        document.getElementById('monthPct').style.color = allTime>=0?'var(--green)':'var(--red)';
        
        // Portfolio summary
        const totalUnrealized = OPEN_POSITIONS.reduce((s,p) => s+p.unrealizedPnl, 0);
        const totalRealized = allTime;
        setStatVal('totalRealizedPnl', totalRealized);
        document.getElementById('totalRealizedPct').textContent = `${(totalRealized/INITIAL_ASSETS*100).toFixed(2)}% of initial capital`;
        document.getElementById('totalRealizedPct').style.color = 'var(--text-dim)';
        setStatVal('totalUnrealizedPnl', totalUnrealized);
        
        // Monthly cards
        const greenDays = monthVals.filter(v=>v>0).length;
        const redDays = monthVals.filter(v=>v<0).length;
        const totalDays = monthVals.filter(v=>v!==0).length;
        const winRate = totalDays>0?(greenDays/totalDays*100).toFixed(1):0;
        const best = monthVals.length?Math.max(...monthVals):0;
        const worst = monthVals.length?Math.min(...monthVals):0;
        
        document.getElementById('totalTrades').textContent = totalDays;
        document.getElementById('winRate').textContent = winRate+'%';
        document.getElementById('winRateBar').style.width = winRate+'%';
        document.getElementById('bestDay').textContent = '+$'+best.toFixed(2);
        document.getElementById('worstDay').textContent = '$'+worst.toFixed(2);
        document.getElementById('greenDays').textContent = greenDays;
        document.getElementById('redDays').textContent = redDays;
        
        // Streak
        if (allDays.length >= 2) {
            document.getElementById('streakSection').style.display = 'block';
            const {current, best: bestStreak, worst: worstStreak} = calcStreaks(allDays);
            document.getElementById('streakCounters').innerHTML = `
                <div class="streak-counter current">Current: ${current>0?'+'+current:current}</div>
                <div class="streak-counter best">Best Win: ${bestStreak}ğŸ”¥</div>
                <div class="streak-counter worst">Worst Loss: ${worstStreak}ğŸ’€</div>
            `;
            document.getElementById('streakBar').innerHTML = allDays.slice(-20).map(d =>
                `<div class="streak-dot ${d.val>=0?'streak-win':'streak-loss'}" title="${d.sort}: ${d.val>=0?'+':''}$${d.val.toFixed(2)}">${d.val>=0?'W':'L'}</div>`
            ).join('');
        }
        
        document.getElementById('lastUpdate').textContent = 'ğŸ• Updated: 2026-02-24 18:13:44 UTC';
        
        // Trades
        if (TRADES.length > 0) {
            document.getElementById('emptyTrades').style.display = 'none';
            const tbody = document.getElementById('tradesBody');
            tbody.innerHTML = TRADES.slice().reverse().map((t, i) => {
                const dirClass = t.result >= 0 ? 'badge-long' : 'badge-short';
                const dirLabel = t.result >= 0 ? 'ğŸ“ˆ LONG' : 'ğŸ“‰ SHORT';
                return `<tr>
                    <td style="color:var(--text-dim)">${TRADES.length-i}</td>
                    <td>${t.date}</td>
                    <td><strong>${t.pair}</strong></td>
                    <td><span class="badge ${dirClass}">${dirLabel}</span></td>
                    <td style="color:var(--text-dim)">${t.entry}</td>
                    <td style="color:var(--text-dim)">${t.exit}</td>
                    <td style="color:var(--text-dim)">${t.lev}</td>
                    <td style="color:${t.result>=0?'var(--green)':'var(--red)'};font-weight:800">${t.result>=0?'+':''}$${t.result.toFixed(2)}</td>
                    <td style="color:var(--text-dim);font-size:0.78rem">${t.notes||''}</td>
                </tr>`;
            }).join('');
        } else {
            document.getElementById('emptyTrades').style.display = 'block';
        }
    }
    
    function setStatVal(id, val) {
        const el = document.getElementById(id);
        const prefix = val>0?'+':'';
        el.textContent = prefix+'$'+val.toFixed(2);
        el.style.color = val>=0?'var(--green)':'var(--red)';
    }
    
    function renderOpenPositions() {
        const container = document.getElementById('openPositions');
        if (OPEN_POSITIONS.length === 0) { document.getElementById('openPositionsSection').style.display='none'; return; }
        container.innerHTML = OPEN_POSITIONS.map(p => {
            const isProfit = p.unrealizedPnl >= 0;
            const unitLabel = p.pair.split('/')[0];
            return `
            <div class="pos-card ${isProfit?'pos-profit':'pos-loss'}">
                <div class="pos-header">
                    <div><span class="pos-pair">${p.pair}</span><span class="live-dot"></span></div>
                    <div class="pos-badges">
                        <span class="pos-badge ${p.direction.toLowerCase()}">${p.direction}</span>
                        <span class="pos-badge">${p.mode}</span>
                        <span class="pos-badge">${p.leverage}</span>
                    </div>
                </div>
                <div style="display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:18px;">
                    <div>
                        <div class="pos-label" style="font-size:0.72rem;color:var(--text-dim);font-weight:500">Unrealized PnL</div>
                        <div class="pos-pnl-big ${isProfit?'green':'red'}">${isProfit?'+':''}$${p.unrealizedPnl.toFixed(2)}</div>
                    </div>
                    <div style="text-align:left">
                        <div class="pos-label" style="font-size:0.72rem;color:var(--text-dim);font-weight:500">ROI</div>
                        <div class="pos-roi ${isProfit?'green':'red'}">${isProfit?'+':''}${p.roi}%</div>
                    </div>
                </div>
                <div class="pos-grid">
                    <div class="pos-item"><div class="pos-label">Entry Price</div><div class="pos-val">$${p.entry}</div></div>
                    <div class="pos-item"><div class="pos-label">Mark Price</div><div class="pos-val">$${p.markPrice}</div></div>
                    <div class="pos-item"><div class="pos-label">Size</div><div class="pos-val">${p.size.toLocaleString()} ${unitLabel}</div></div>
                    <div class="pos-item"><div class="pos-label">Margin</div><div class="pos-val">$${p.margin.toFixed(2)}</div></div>
                    <div class="pos-item"><div class="pos-label">Liq. Price</div><div class="pos-val red">$${p.liqPrice}</div></div>
                    <div class="pos-item"><div class="pos-label">Realized PnL</div><div class="pos-val green">+$${p.realizedPnl.toFixed(2)}</div></div>
                </div>
                <div class="pos-tpsl">
                    <span>ğŸ¯ TP: <strong class="green">$${p.tp}</strong></span>
                    <span>ğŸ›‘ SL: <strong class="red">$${p.sl}</strong></span>
                </div>
            </div>`;
        }).join('');
    }
    
    // ==================== NEW FEATURES ====================

    function renderEquityCurve() {
        const svg = document.getElementById('equityCurve');
        const allDays = [];
        Object.entries(DAILY_PNL).forEach(([month, days]) => {
            Object.entries(days).forEach(([day, val]) => {
                allDays.push({ sort: month+'-'+String(day).padStart(2,'0'), val, label: day+'/'+month.split('-')[1] });
            });
        });
        allDays.sort((a,b) => a.sort.localeCompare(b.sort));
        if (allDays.length < 2) return;

        let cum = 0;
        const points = allDays.map(d => { cum += d.val; return { ...d, cum }; });
        const w = svg.clientWidth || 800, h = svg.clientHeight || 200;
        const pad = { top: 20, right: 15, bottom: 25, left: 55 };
        const gw = w - pad.left - pad.right, gh = h - pad.top - pad.bottom;
        const minY = Math.min(0, ...points.map(p=>p.cum)), maxY = Math.max(0, ...points.map(p=>p.cum));
        const rangeY = maxY - minY || 1;

        const xScale = i => pad.left + (i / (points.length - 1)) * gw;
        const yScale = v => pad.top + (1 - (v - minY) / rangeY) * gh;

        let svgContent = '';
        // Grid lines
        for (let i = 0; i < 4; i++) {
            const v = minY + (rangeY * i / 3);
            const y = yScale(v);
            svgContent += `<line class="grid-line" x1="${pad.left}" y1="${y}" x2="${w-pad.right}" y2="${y}"/>`;
            svgContent += `<text class="axis-label" x="${pad.left-8}" y="${y+3}" text-anchor="end">${v>=0?'+':''}$${v.toFixed(0)}</text>`;
        }
        // Zero line
        const zeroY = yScale(0);
        svgContent += `<line class="zero-line" x1="${pad.left}" y1="${zeroY}" x2="${w-pad.right}" y2="${zeroY}"/>`;

        // Build path
        const pathPts = points.map((p,i) => `${xScale(i)},${yScale(p.cum)}`);
        const lineColor = points[points.length-1].cum >= 0 ? 'var(--green)' : 'var(--red)';
        const areaColor = points[points.length-1].cum >= 0 ? 'var(--green)' : 'var(--red)';
        svgContent += `<polyline class="line" points="${pathPts.join(' ')}" stroke="${lineColor}"/>`;
        // Area
        svgContent += `<polygon class="area" points="${xScale(0)},${yScale(0)} ${pathPts.join(' ')} ${xScale(points.length-1)},${yScale(0)}" fill="${areaColor}"/>`;
        // Dots
        points.forEach((p,i) => {
            const color = p.cum >= 0 ? 'var(--green)' : 'var(--red)';
            svgContent += `<circle class="dot" cx="${xScale(i)}" cy="${yScale(p.cum)}" fill="${color}" stroke="var(--card)"><title>${p.label}: ${p.cum>=0?'+':''}$${p.cum.toFixed(2)}</title></circle>`;
        });
        // X labels (first, mid, last)
        [0, Math.floor(points.length/2), points.length-1].forEach(i => {
            svgContent += `<text class="axis-label" x="${xScale(i)}" y="${h-4}" text-anchor="middle">${points[i].label}</text>`;
        });

        svg.innerHTML = svgContent;
    }

    function renderBarChart() {
        const svg = document.getElementById('barChart');
        const data = DAILY_PNL[currentMonth] || {};
        const entries = Object.entries(data).map(([d,v]) => ({day:parseInt(d),val:v})).sort((a,b)=>a.day-b.day);
        const names = {"01":"January","02":"February","03":"March","04":"April","05":"May","06":"June","07":"July","08":"August","09":"September","10":"October","11":"November","12":"December"};
        document.getElementById('barChartMonth').textContent = names[currentMonth.split('-')[1]] || '';
        if (!entries.length) { svg.innerHTML = '<text x="50%" y="50%" text-anchor="middle" fill="var(--text-dim)" font-size="14">No data</text>'; return; }

        const w = svg.clientWidth || 800, h = svg.clientHeight || 180;
        const pad = { top: 20, right: 10, bottom: 25, left: 50 };
        const gw = w - pad.left - pad.right, gh = h - pad.top - pad.bottom;
        const maxAbs = Math.max(...entries.map(e=>Math.abs(e.val)), 1);
        const barW = Math.min(Math.floor(gw / entries.length) - 4, 30);
        const gap = (gw - barW * entries.length) / (entries.length + 1);
        const zeroY = pad.top + gh / 2;

        let svgContent = `<line class="zero-line" x1="${pad.left}" y1="${zeroY}" x2="${w-pad.right}" y2="${zeroY}" style="opacity:0.6"/>`;
        entries.forEach((e, i) => {
            const x = pad.left + gap + i * (barW + gap);
            const barH = (Math.abs(e.val) / maxAbs) * (gh / 2);
            const y = e.val >= 0 ? zeroY - barH : zeroY;
            const color = e.val >= 0 ? 'var(--green)' : 'var(--red)';
            svgContent += `<rect class="bar" x="${x}" y="${y}" width="${barW}" height="${barH}" fill="${color}"><title>Day ${e.day}: ${e.val>=0?'+':''}$${e.val.toFixed(2)}</title></rect>`;
            svgContent += `<text class="bar-label" x="${x+barW/2}" y="${h-6}">${e.day}</text>`;
            if (Math.abs(e.val) > maxAbs * 0.15) {
                const valY = e.val >= 0 ? y - 4 : y + barH + 10;
                svgContent += `<text class="bar-val" x="${x+barW/2}" y="${valY}" fill="${color}">${e.val>=0?'+':''}${Math.abs(e.val)>=1000?(e.val/1000).toFixed(1)+'K':e.val.toFixed(0)}</text>`;
            }
        });
        svg.innerHTML = svgContent;
    }

    function renderDiscipline() {
        const data = DAILY_PNL[currentMonth] || {};
        const vals = Object.values(data);
        if (!vals.length) return;

        // Factors
        const daysOver50Loss = vals.filter(v => v < -50).length;
        const daysOver50Pct = vals.length > 0 ? (1 - daysOver50Loss / vals.length) * 100 : 100;
        const consecutiveLosses = (() => { let max=0,c=0; vals.forEach(v => { if(v<0){c++;max=Math.max(max,c)}else{c=0} }); return max; })();
        const stoppedAfter2 = consecutiveLosses <= 2 ? 100 : Math.max(0, 100 - (consecutiveLosses - 2) * 25);
        const greenRatio = vals.filter(v=>v>0).length / vals.length * 100;
        const avgWin = vals.filter(v=>v>0).length ? vals.filter(v=>v>0).reduce((s,v)=>s+v,0)/vals.filter(v=>v>0).length : 0;
        const avgLoss = vals.filter(v=>v<0).length ? Math.abs(vals.filter(v=>v<0).reduce((s,v)=>s+v,0)/vals.filter(v=>v<0).length) : 0;
        const rrScore = avgLoss > 0 ? Math.min((avgWin / avgLoss) / 2 * 100, 100) : 100;

        const score = Math.round(daysOver50Pct * 0.35 + stoppedAfter2 * 0.3 + rrScore * 0.2 + Math.min(greenRatio * 1.5, 100) * 0.15);
        const clampedScore = Math.max(0, Math.min(100, score));

        const ring = document.getElementById('disciplineRing');
        const circ = 2 * Math.PI * 65;
        ring.style.strokeDasharray = circ;
        ring.style.strokeDashoffset = circ - (clampedScore / 100) * circ;
        ring.style.stroke = clampedScore >= 75 ? 'var(--green)' : clampedScore >= 50 ? 'var(--gold)' : 'var(--red)';

        const scoreEl = document.getElementById('disciplineScore');
        scoreEl.textContent = clampedScore;
        scoreEl.style.color = clampedScore >= 75 ? 'var(--green)' : clampedScore >= 50 ? 'var(--gold)' : 'var(--red)';

        document.getElementById('disciplineLabel').textContent = clampedScore >= 80 ? 'ğŸ”¥ Excellent Discipline!' : clampedScore >= 60 ? 'âš¡ Decent â€” Room to Improve' : 'âš ï¸ Needs Work!';

        const factors = [
            { label: `$50 limit: ${daysOver50Loss} violations`, cls: daysOver50Loss === 0 ? 'factor-ok' : daysOver50Loss <= 2 ? 'factor-warn' : 'factor-bad', icon: daysOver50Loss === 0 ? 'âœ…' : 'âš ï¸' },
            { label: `Max consec. losses: ${consecutiveLosses}`, cls: consecutiveLosses <= 2 ? 'factor-ok' : consecutiveLosses <= 3 ? 'factor-warn' : 'factor-bad', icon: consecutiveLosses <= 2 ? 'âœ…' : 'âŒ' },
            { label: `Avg R:R ${avgLoss>0?(avgWin/avgLoss).toFixed(1):'âˆ'}:1`, cls: avgWin/avgLoss >= 2 ? 'factor-ok' : avgWin/avgLoss >= 1 ? 'factor-warn' : 'factor-bad', icon: avgWin/avgLoss >= 2 ? 'âœ…' : 'âš ï¸' },
        ];
        document.getElementById('disciplineFactors').innerHTML = factors.map(f => `<div class="discipline-factor"><span>${f.icon}</span><span class="${f.cls}">${f.label}</span></div>`).join('');
    }

    function renderAdvancedStats() {
        const allDays = [];
        Object.entries(DAILY_PNL).forEach(([month, days]) => {
            Object.entries(days).forEach(([day, val]) => { allDays.push(val); });
        });
        const wins = allDays.filter(v=>v>0), losses = allDays.filter(v=>v<0);
        const avgWin = wins.length ? wins.reduce((s,v)=>s+v,0)/wins.length : 0;
        const avgLoss = losses.length ? Math.abs(losses.reduce((s,v)=>s+v,0)/losses.length) : 0;
        const profitFactor = avgLoss > 0 && losses.length > 0 ? (wins.reduce((s,v)=>s+v,0)) / Math.abs(losses.reduce((s,v)=>s+v,0)) : 0;

        // Max drawdown
        let peak = 0, cum = 0, maxDD = 0;
        allDays.forEach(v => { cum += v; peak = Math.max(peak, cum); maxDD = Math.min(maxDD, cum - peak); });

        // Expectancy
        const wr = allDays.length ? wins.length / allDays.length : 0;
        const expectancy = wr * avgWin - (1 - wr) * avgLoss;

        const stats = [
            { label: 'Avg Win', value: '+$'+avgWin.toFixed(2), color: 'var(--green)' },
            { label: 'Avg Loss', value: '-$'+avgLoss.toFixed(2), color: 'var(--red)' },
            { label: 'Profit Factor', value: profitFactor.toFixed(2), color: profitFactor >= 1 ? 'var(--green)' : 'var(--red)' },
            { label: 'Max Drawdown', value: '$'+maxDD.toFixed(2), color: 'var(--red)' },
            { label: 'Expectancy', value: (expectancy>=0?'+':'')+'$'+expectancy.toFixed(2), color: expectancy >= 0 ? 'var(--green)' : 'var(--red)' },
            { label: 'Total Trades', value: allDays.length, color: 'var(--blue)' },
        ];
        document.getElementById('advStats').innerHTML = stats.map(s => `<div class="adv-stat"><div class="adv-label">${s.label}</div><div class="adv-value" style="color:${s.color}">${s.value}</div></div>`).join('');
    }

    function renderGoalTracker() {
        const MONTHLY_GOAL = 500; // $500 monthly goal
        const data = DAILY_PNL[currentMonth] || {};
        const monthPnl = Object.values(data).reduce((s,v)=>s+v, 0);
        const pct = Math.max(0, Math.min((monthPnl / MONTHLY_GOAL) * 100, 100));
        const color = monthPnl >= MONTHLY_GOAL ? 'var(--green)' : monthPnl >= 0 ? 'var(--blue)' : 'var(--red)';
        const milestones = [100, 250, 500].map(m => ({val:m, reached: monthPnl >= m}));

        document.getElementById('goalContent').innerHTML = `
            <div style="font-size:0.85rem;color:var(--text-dim);margin-bottom:4px;">Target: <strong style="color:var(--text)">+$${MONTHLY_GOAL}</strong> this month</div>
            <div class="goal-bar-track"><div class="goal-bar-fill" style="width:${monthPnl>0?pct:0}%;background:${color}"></div></div>
            <div class="goal-info">
                <span class="current" style="color:${color}">${monthPnl>=0?'+':''}$${monthPnl.toFixed(2)}</span>
                <span style="color:var(--text-dim)">${pct.toFixed(0)}% of goal</span>
            </div>
            <div class="goal-milestones">
                ${milestones.map(m=>`<div class="goal-milestone ${m.reached?'reached':''}">$${m.val} ${m.reached?'âœ…':'â¬œ'}</div>`).join('')}
            </div>
        `;
    }

    // Init
    renderMonthSelector();
    renderCalendar();
    renderStats();
    renderOpenPositions();
    renderEquityCurve();
    renderBarChart();
    renderDiscipline();
    renderAdvancedStats();
    renderGoalTracker();
    </script>
</body>
</html>
<!-- cache-bust: 1771956200 -->
